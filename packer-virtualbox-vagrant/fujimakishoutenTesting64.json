{
    "description": "Contrib Debian Jessie base box, build using contrib sources",
    "variables" : {
        "atlas_token" : "{{env `ATLAS_TOKEN`}}",
        "box_changelog" : "Daily build",
        "box_version" : "9.0.0.20170418",
        "description" : "Debian stretch RC3 2017.04.18",
        "vm_name" : "debian-testing"
    },
    "builders" : [{
        "boot_command": [
            "<esc><wait>",
            "install <wait>",
            "preseed/url=http://{{ .HTTPIP }}:{{ .HTTPPort }}/stretch-preseed.cfg <wait>",
            "auto <wait>",
            "locale=en_US <wait>",
            "kbd-chooser/method=us <wait>",
            "netcfg/get_hostname={{ .Name }} <wait>",
            "netcfg/get_domain=vagrantup.com <wait>",
            "fb=false <wait>",
            "debconf/frontend=noninteractive <wait>",
            "console-setup/ask_detect=false <wait>",
            "console-keymaps-at/keymap=us <wait>",
            "keyboard-configuration/xkb-keymap=us <wait>",
            "net.ifnames=0 <wait>",
            "<enter><wait>"
        ],
        "disk_size" : "10140",
        "guest_os_type" : "Debian_64",
        "hard_drive_interface" : "sata",
        "headless" : false,
        "http_directory" : "http",
        "iso_checksum" : "46a770bb8de9e90f34fe504959e290b0bdab905c61ccc975fbf91f47aef952fb7ea70d80d1c89a421189a673c9e37c6fd6a3d21db507805ecdc319e8f3928f11",
        "iso_checksum_type" : "sha512",
        "iso_url" : "http://cdimage.debian.org/cdimage/daily-builds/daily/arch-latest/amd64/iso-cd/debian-testing-amd64-netinst.iso",
        "shutdown_command" : "sudo /sbin/halt -p",
        "ssh_password" : "vagrant",
        "ssh_port" : "22",
        "ssh_username" : "vagrant",
        "ssh_wait_timeout" : "10000s",
        "type" : "virtualbox-iso",
        "vboxmanage" : [
            ["modifyvm", "{{.Name}}", "--memory", "512"],
            ["modifyvm", "{{.Name}}", "--cpus", "1"]
         ],
        "vm_name" : "{{user `vm_name`}}"
    }],
    "provisioners" : [{
        "environment_vars" : [
            "VAGRANT_BUILDER_FS=/",
            "VAGRANT_BUILDER_HOSTNAME={{user `vm_name`}}"
        ],
        "execute_command" : "echo 'vagrant'| {{.Vars}} sudo --preserve-env --stdin sh '{{.Path}}'",
        "override" : {
            "virtualbox-iso" : {
                "scripts" : [
                    "scripts/apt.sh",
                    "scripts/fujimakishouten-vagrant-setup.sh",
                    "scripts/vb-guest-additions.sh",
                    "scripts/minimize.sh"
                ]
            }
        },
        "pause_before" : "5s",
        "type" : "shell"
    }],
    "post-processors" : [[
        {
            "keep_input_artifact" : true,
            "type" : "vagrant"
        }, {
            "artifact" : "fujimakishouten/debian-stretch64",
            "artifact_type" : "vagrant.box",
            "metadata" : {
                "description" : "{{user `description`}}",
                "provider" : "virtualbox",
                "version" : "{{user `box_version`}}"
            },
            "token" : "{{user `atlas_token`}}",
            "type" : "atlas"
        }
    ]]
}

